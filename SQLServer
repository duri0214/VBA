Private con As New ADODB.Connection

Sub Connect(ipOrServername As String, dbname As String, usrId As String, pwd As String)
    
    Dim con_string As String
    con_string = "data Source={0} ; Initial Catalog={1} ;"
    con_string = Replace(con_string, "{0}", ipOrServername)
    con_string = Replace(con_string, "{1}", dbname)

    con.provider = "SQLOLEDB"
    con.Open ConnectionString:=con_string, UserID:=usrId, Password:=pwd

End Sub

Function GetCon() As ADODB.Connection
    Set GetCon = con
End Function

Function GetCursor(sql As String) As ADODB.Recordset

    'adOpenStaticは、レコード件数を保持します
    Dim rs As New ADODB.Recordset
    rs.Open sql, con, adOpenStatic, adLockReadOnly
    Set GetCursor = rs

End Function

Sub DisConnect()
    con.Close
End Sub
